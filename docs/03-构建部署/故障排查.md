# æ•…éšœæ’æŸ¥

## æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f

# æŸ¥çœ‹å•ä¸ªæœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f backend
docker-compose -f docker-compose.prod.yml logs -f web
docker-compose -f docker-compose.prod.yml logs -f mysql
docker-compose -f docker-compose.prod.yml logs -f nginx
```

## è¿›å…¥å®¹å™¨è°ƒè¯•

```bash
# è¿›å…¥åç«¯å®¹å™¨
docker-compose -f docker-compose.prod.yml exec backend sh

# è¿›å…¥å‰ç«¯å®¹å™¨
docker-compose -f docker-compose.prod.yml exec web sh

# è¿›å…¥æ•°æ®åº“å®¹å™¨
docker-compose -f docker-compose.prod.yml exec mysql sh
```

## å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šé•œåƒæ„å»ºå¤±è´¥

**ç—‡çŠ¶**ï¼š`npm run build` æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ¸…ç† Docker ç¼“å­˜
docker system prune -a

# é‡æ–°æ„å»ºï¼ˆä¸ä½¿ç”¨ç¼“å­˜ï¼‰
docker-compose -f docker-compose.prod.yml build --no-cache

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h
```

### é—®é¢˜ 2ï¼šå®¹å™¨æ— æ³•å¯åŠ¨

**ç—‡çŠ¶**ï¼šå®¹å™¨çŠ¶æ€ä¸º `Exited` æˆ– `Restarting`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs backend
docker-compose -f docker-compose.prod.yml logs web

# æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
cat backend/.env

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :80
netstat -tulpn | grep :3000
```

### é—®é¢˜ 3ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼šåç«¯æ—¥å¿—æ˜¾ç¤ºæ•°æ®åº“è¿æ¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ MySQL å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps mysql

# æ£€æŸ¥æ•°æ®åº“é…ç½®
docker-compose -f docker-compose.prod.yml exec mysql mysql -uroot -p${DB_PASSWORD} -e "SELECT 1;"

# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
docker-compose -f docker-compose.prod.yml run --rm backend npm run db:init
```

### é—®é¢˜ 4ï¼šå‰ç«¯æ— æ³•è®¿é—®åç«¯ API

**ç—‡çŠ¶**ï¼šå‰ç«¯é¡µé¢æ˜¾ç¤º API è¯·æ±‚å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ Nginx é…ç½®
docker-compose -f docker-compose.prod.yml exec nginx nginx -t

# æ£€æŸ¥åç«¯æœåŠ¡
curl http://localhost:3000/api

# æ£€æŸ¥ CORS é…ç½®
cat backend/.env | grep CORS_ORIGIN
```

### é—®é¢˜ 5ï¼šé•œåƒæ–‡ä»¶å¤ªå¤§ï¼Œä¼ è¾“æ…¢

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ä½¿ç”¨å‹ç¼©ä¼ è¾“
tar -czf yl-images.tar.gz yl-images.tar
scp yl-images.tar.gz user@server:/opt/app/
# åœ¨æœåŠ¡å™¨ä¸Šè§£å‹
tar -xzf yl-images.tar.gz
docker load -i yl-images.tar
```

### é—®é¢˜ 6ï¼šç«¯å£è¢«å ç”¨

**ç—‡çŠ¶**ï¼šå®¹å™¨å¯åŠ¨å¤±è´¥ï¼Œæç¤ºç«¯å£è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :3000  # Windows
lsof -i :3000                 # Linux/Mac

# åœæ­¢å ç”¨ç«¯å£çš„ç¨‹åºæˆ–ä¿®æ”¹é…ç½®ä½¿ç”¨å…¶ä»–ç«¯å£
```

### é—®é¢˜ 7ï¼šæœåŠ¡æ— æ³•è®¿é—®

**ç—‡çŠ¶**ï¼šæµè§ˆå™¨æ— æ³•è®¿é—®æœåŠ¡

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps

# æ£€æŸ¥æœåŠ¡å¥åº·
curl http://localhost/api

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status  # Ubuntu/Debian
sudo firewall-cmd --list-all  # CentOS/RHEL
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [éƒ¨ç½²æŒ‡å—](./éƒ¨ç½²æŒ‡å—.md) - æœåŠ¡å™¨éƒ¨ç½²æµç¨‹
- [ç”Ÿäº§ç¯å¢ƒé…ç½®](./ç”Ÿäº§ç¯å¢ƒé…ç½®.md) - ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–

